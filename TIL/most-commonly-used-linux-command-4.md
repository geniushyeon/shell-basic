# 가장 많이 쓰는 리눅스 명령어(4) - sed
## 1. sed 사용법 알아보기
sed는 스트림 편집기 - 입력 스트림에서 텍스트 변환을 수행하는 데 사용됨
- 입력 스트림: 텍스트를 변경하고자 하는 대상 파일
- 스크립트: 어떤 텍스트를 어덯게 변환할지 정의
### 1.1. 기본 사용법(1)
- 옵션
- 스크립트: 어떤 텍스트를 어떻게 변경할 것인지를 기술
  - 어드레스: 대상 파일의 범위를 지정, 생략되면 대상 파일 전체를 대상으로 명령어 수행
  - 명령어
- 대상 파일
```bash
$ sed [옵션] '어드레스 {명령어}' 대상 파일
```
### 1.2. 기본 사용법(2)
찾을 문자열과 변경하고자 하는 문자열을 스크립트로 작성한 파일을 이용하여 대상 파일의 문자열 변경
```bash
$ sed [옵션] -f 스크립트파일 대상파일
```
### 1.3. 기본 사용법(3)
리눅스 명령어나 애플리케이션의 명령어를 통해 얻은 결과를 이용하여, 해당 결과에서 찾은 문자열을 변경할 때 주로 이용
- 쉘 스크립트 작성 시 다른 명령어들과 함께 사용되며, 특수 문자열을 변경할 경우 많이 사용됨
```bash
명령어 | sed [옵션] '{스크립트}'
```
## 2. sed 스크립트
어떤 범위(addresses)의 어떤 문자열이 포함된 라인을 추출할 것인지, 특정 문자열을 원하는 다른 문자열로 변경(command)할 것인지를 명시하는 일
- addresses는 옵션처럼 생략될 수도 있으며, 생략되면 sed는 대상 파일 전체에서 특정 문자열을 찾고 변경한다.
### 2.1. addresses
대상 파일의 범위, 정의되지 않았을 경우에는 대상 파일 전체에서 특정 문자열을 찾거나 명령어 수행
|옵션|설명|
|--|--|
|number|명시된 숫자에 해당하는 라인 번호일 경우 다음 명령어를 수행함|
|number~step|명시된 숫자에 해당하는 라인부터 명시한 단계만큼 해당 라인을 스킵한 다음 라인일 경우 다음 명령어를 수행함|
|$|파일의 마지막 라인일 경우 다음 명령어를 수행함|
|/regexp/|명시한 정규 표현식과 일치하는 라인일 경우 다음 명령어를 수행함|
|\cregexpc|명시한 정규 표현식과 일치하는 라인일 경우 다음 명령어를 수행함|
|0,addr2|1번째 라인부터 addr2가 포함된 라인까지가 범위이며, addr2는 정규 표현식이어야 함|
|addr1, +N|addr1이 포함된 라인부터 +N라인까지가 범위이며, addr1은 정규 표현식, N은 숫자여야 함|
|addr1,~N|addr1이 포함된 라인을 기준으로 N라인까지가 범위이며, addr1은 정규 표현식, N은 숫자여야 함|
### 2.2. 명령어
#### 2.2.1. 0 or 1 어드레스 명령어
|옵션|설명|
|--|--|
|:label|라벨|
|#comment|주석|
|{ ... }|블록|
|=|현재 라인 번호 출력|
|a \ text|문자열 추가|
|i \text|문자열 삽입|
|q/Q|sed 스크립트 실행 종료
|r 파일명|파일 내용 추가|
|R 파일명|파일의 첫 라인 추가
- sed에서 사용되는 명령어들은 한 라인에 한 명령어만 사용할 수 있음 -> 여러 줄의 명령어를 사용하려면 중괄호{}로 블록을 만들어줘야 함
#### 2.2.2. 어드레스 범위 명령어
|옵션|설명|
|--|--|
|b label|라벨을 호출함|
|c \ text|앞에서 명시된 패턴이 포함된 라인을 text 문자열로 변경|
|d D|앞에서 명시된 패턴 삭제|
|h H|패턴 공간을 홀드 공간에 복사/추가|
|g G|홀드 공간을 패턴 공간에 복사/추가|
|l|입력된 데이터의 현재 라인 출력|
|l width|명시한 너비에 맞게 입력된 데이터의 현재 라인 출력|
|n N|입력된 데이터의 다음 라인을 복사/추가|
|p P|현재 패턴 공간 출력|
|s/regexp/replacement|정규 표현식에 해당하는 데이터를 그 다음에 오는 데이터로 변경함|
|t label/T label|앞에서 선언된 명령어를 실행 후 라벨로 분기|
|w 파일명/W 파일명|명시한 파일에 현재 패턴 공간을 저장함|
|x|홀드와 패턴 공간의 콘텐츠를 교환함|
|y/source/dest/|패턴이 포함된 라인의 문자열(source)을 dest 문자열로 변경|

### 2.3. sed 옵션
|옵션|설명|
|--|--|
|-n, --quiet, --silent|현재 패턴 공간을 출력하지 않음|
|-e 스크립트, --expression=스크립트|여러 개의 스크립트를 실행할 때 사용함|
|-f 스크립트파일, --file=스크립트파일|스크립트 파일을 통해 sed를 실행할 때 사용|
|--follow-symlinks|-i 옵션과 함께 사용할 경우 스크립트 실행 결과를 심볼릭 링크 자체가 아닌 심볼릭 링크와 연결된 원본 파일에 저장함|
|-i 파일확장자, --in-place=파일확장자|스크립트 실행 결과를 파일에 바로 적용함. 이때, 파일 확장자를 명시하면 변경 전 명시한 확장자를 가진 백업 파일을 생성|
|-c, --copy|-i 옵션과 함께 사용할 수 있으며, 파일명 뒤에 c가 붙은 백업 파일을 생성함|
|-l N, --line-length=N|l 명령어와 함께 사용할 수 있으며, 긴 문자열을 포함하는 파일의 내용을 확인할 경우 명시한 N만큼 라인 넓이를 설정할 수 있음|